---
import GlobalLayout from '../../layouts/GlobalLayout.astro';
import PostGallery from "../../components/PostGallery.astro";
import H1 from "../../components/H1.astro";


import { getCollection } from "astro:content";
import Pagination from '../../components/Pagination.astro';

export async function getStaticPaths({ paginate }) {
  const posts = await getCollection("posts");

  const sorted = posts.sort((a, b) => {
    const [dayA, monthA, yearA] = a.data.date.split("/");
    const [dayB, monthB, yearB] = b.data.date.split("/");
    return new Date(`${yearB}-${monthB}-${dayB}`) - new Date(`${yearA}-${monthA}-${dayA}`);
  }).reverse();

  return paginate(sorted, { pageSize: 5 });
}

const { page } = Astro.props;
---

<GlobalLayout title="Blog posts">
  <div class="posts-page">
    <H1 text="Blog posts" />
    <PostGallery posts={page.data} />
    <Pagination currentPage={page.currentPage} lastPage={page.lastPage} url={page.url} />
  </div>
</GlobalLayout>

<style>
  .posts-page {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 40px;
    padding-bottom: 2rem;
  }

</style>
